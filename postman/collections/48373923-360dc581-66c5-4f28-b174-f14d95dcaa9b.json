{
	"info": {
		"_postman_id": "48373923-360dc581-66c5-4f28-b174-f14d95dcaa9b",
		"name": "EMI Manager API",
		"description": "Complete API collection for EMI Manager Laravel application with authentication, user management, and location services",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{token}}",
				"type": "string"
			}
		]
	},
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Auto-set base URL if not set",
					"if (!pm.collectionVariables.get('base_url')) {",
					"    pm.collectionVariables.set('base_url', 'http://localhost:8000/api');",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Auto-extract token from login response",
					"if (pm.info.requestName === 'Login' && pm.response.code === 200) {",
					"    const response = pm.response.json();",
					"    if (response.data && response.data.token) {",
					"        pm.collectionVariables.set('token', response.data.token);",
					"        console.log('Token extracted and saved:', response.data.token);",
					"    }",
					"}",
					"",
					"// Basic response validation",
					"pm.test('Status code is successful', function () {",
					"    pm.expect(pm.response.code).to.be.oneOf([200, 201, 204]);",
					"});",
					"",
					"pm.test('Response is JSON', function () {",
					"    pm.expect(pm.response.headers.get('Content-Type')).to.include('application/json');",
					"});",
					"",
					"// Check for API response structure",
					"if (pm.response.code === 200 || pm.response.code === 201) {",
					"    pm.test('Response has success structure', function () {",
					"        const response = pm.response.json();",
					"        pm.expect(response).to.have.property('success');",
					"        pm.expect(response.success).to.be.true;",
					"    });",
					"}"
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8000/api",
			"type": "string"
		},
		{
			"key": "token",
			"value": "",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "Authentication",
			"item": [
				{
					"name": "Login",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"email_or_phone\": \"admin@example.com\",\n  \"password\": \"password123\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/login",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"login"
							]
						},
						"description": "Login with email/phone and password. Returns user data and access token."
					}
				},
				{
					"name": "Logout",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/auth/logout",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"logout"
							]
						},
						"description": "Logout and invalidate current access token."
					}
				},
				{
					"name": "Get Profile",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/auth/profile",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"profile"
							]
						},
						"description": "Get authenticated user profile with addresses and role information."
					}
				},
				{
					"name": "Change Password",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"current_password\": \"oldpassword123\",\n  \"new_password\": \"newpassword123\",\n  \"new_password_confirmation\": \"newpassword123\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/auth/change-password",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"auth",
								"change-password"
							]
						},
						"description": "Change user password. Requires current password for verification."
					}
				}
			]
		},
		{
			"name": "User Management",
			"item": [
				{
					"name": "Get Users",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/users",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"users"
							]
						},
						"description": "Get paginated list of users based on hierarchy. Super admins see all users, others see their subordinates."
					}
				},
				{
					"name": "Create User",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"John Doe\",\n  \"email\": \"john@example.com\",\n  \"phone\": \"01712345678\",\n  \"password\": \"password123\",\n  \"role\": \"customer\",\n  \"present_address\": {\n    \"street_address\": \"123 Main Street\",\n    \"landmark\": \"Near City Bank\",\n    \"postal_code\": \"1200\",\n    \"division_id\": 1,\n    \"district_id\": 1,\n    \"upazilla_id\": 1\n  },\n  \"permanent_address\": {\n    \"street_address\": \"456 Home Street\",\n    \"landmark\": \"Near School\",\n    \"postal_code\": \"1201\",\n    \"division_id\": 1,\n    \"district_id\": 1,\n    \"upazilla_id\": 1\n  },\n  \"bkash_merchant_number\": \"01712345678\",\n  \"nagad_merchant_number\": \"01712345679\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/users",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"users"
							]
						},
						"description": "Create a new user with complete profile including addresses and merchant numbers."
					}
				},
				{
					"name": "Get User Details",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/users/1",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"users",
								"1"
							]
						},
						"description": "Get detailed information about a specific user including addresses, role, and hierarchy."
					}
				},
				{
					"name": "Update User",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"name\": \"John Doe Updated\",\n  \"email\": \"john.updated@example.com\",\n  \"phone\": \"01712345679\",\n  \"bkash_merchant_number\": \"01712345680\",\n  \"nagad_merchant_number\": \"01712345681\",\n  \"is_active\": true\n}"
						},
						"url": {
							"raw": "{{base_url}}/users/1",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"users",
								"1"
							]
						},
						"description": "Update user information. Only super admins can change is_active status."
					}
				},
				{
					"name": "Reset User Password",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							},
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"new_password\": \"newpassword123\",\n  \"can_change_password\": true\n}"
						},
						"url": {
							"raw": "{{base_url}}/users/1/reset-password",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"users",
								"1",
								"reset-password"
							]
						},
						"description": "Reset user password. Only available for super admins."
					}
				},
				{
					"name": "Get Available Roles",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/users/available-roles",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"users",
								"available-roles"
							]
						},
						"description": "Get list of roles that current user can assign to new users based on hierarchy."
					}
				}
			]
		},
		{
			"name": "Locations",
			"item": [
				{
					"name": "Get Divisions",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/locations/divisions",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"locations",
								"divisions"
							]
						},
						"description": "Get all active divisions for address selection."
					}
				},
				{
					"name": "Get Districts by Division",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/locations/districts/1",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"locations",
								"districts",
								"1"
							]
						},
						"description": "Get all active districts for a specific division."
					}
				},
				{
					"name": "Get Upazillas by District",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/locations/upazillas/1",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"locations",
								"upazillas",
								"1"
							]
						},
						"description": "Get all active upazillas for a specific district."
					}
				}
			]
		},
		{
			"name": "Dashboard",
			"item": [
				{
					"name": "Get Dashboard Stats",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							},
							{
								"key": "Authorization",
								"value": "Bearer {{token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/dashboard/stats",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"dashboard",
								"stats"
							]
						},
						"description": "Get dashboard statistics. Super admins get global stats, others get personal stats."
					}
				}
			]
		},
		{
			"name": "System",
			"item": [
				{
					"name": "API Test",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/test",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"test"
							]
						},
						"description": "Test API connectivity and get Laravel version info."
					}
				},
				{
					"name": "Health Check",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/health",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"health"
							]
						},
						"description": "Health check endpoint for monitoring service status."
					}
				}
			]
		},
		{
			"name": "Debug (Development Only)",
			"item": [
				{
					"name": "Debug Users",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/debug/users",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"debug",
								"users"
							]
						},
						"description": "Debug endpoint to view all users with roles (development environment only)."
					}
				},
				{
					"name": "Debug Roles",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{base_url}}/debug/roles",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"debug",
								"roles"
							]
						},
						"description": "Debug endpoint to view all roles and permissions (development environment only)."
					}
				}
			]
		}
	]
}